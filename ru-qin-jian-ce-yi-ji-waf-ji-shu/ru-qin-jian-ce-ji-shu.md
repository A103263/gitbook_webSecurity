---
description: 入侵概念
---

# 入侵技术概念

## 入侵的概念

![&#x5165;&#x4FB5;&#x7684;&#x5F71;&#x54CD;](../.gitbook/assets/image%20%2868%29.png)

![&#x5165;&#x4FB5;&#x7684;&#x6982;&#x5FF5;](../.gitbook/assets/image%20%2877%29.png)

![](../.gitbook/assets/image%20%28130%29.png)

![](../.gitbook/assets/image%20%2860%29.png)

网络入侵与网络攻击

![](../.gitbook/assets/image%20%2837%29.png)

## 入侵行为的特征

### 1.入侵行为的特征概述

一组能确定网络访问或系统行为是入侵行为的**字符串、数据、行为模式或符号组合**等，入侵行为的这些特征，是入侵检测系统鉴别入侵行为的基本依据。

入侵检测系统分为两类：基于网络的入侵检测系统（NIDS）和基于操作系统的入侵检测系统（HIDS）

对于NIDS，入侵行为的特征，可以是**IP地址、端口号、某些标志组合、数据包长度以及数据包内容中包含的特定字符串**等

对于HIDS，入侵行为的特征还包括对**目标系统的频繁访问尝试、对系统配置文件的访问尝试以及目标系统上运行（安装）程序的名称、占用的端口号、注册表项**等的读取。

### 2.入侵行为的特征分类

1. 利用某些终端协议机制的缺陷，识别入侵行为；
2. 利用畸形IP数据包特征，识别入侵行为；
3. 利用TCP报文中的畸形标记组合，识别攻击行为；
4. 利用日志或数据部分的特殊组合，识别入侵行为；
5. 利用网络协议的缺陷，识别入侵行为；

### 3.详解入侵行为

#### 1.针对TCP标记的攻击

TCP的标记

```text
SYN - 同步标志
ACK - 确认标志
RST - 复位标志
URG - 紧急标志
PSH - 推标志
FIN - 结束标志
```

详解：[http://blog.51cto.com/jim123/1853000](http://blog.51cto.com/jim123/1853000)  


![&#x9488;&#x5BF9;TCP&#x6807;&#x8BB0;&#x7684;&#x653B;&#x51FB;](../.gitbook/assets/image%20%2884%29.png)

![](../.gitbook/assets/image%20%28139%29.png)

![](../.gitbook/assets/image%20%2888%29.png)

![](../.gitbook/assets/image%20%28127%29.png)

![](../.gitbook/assets/image%20%2839%29.png)

![](../.gitbook/assets/image%20%2878%29.png)

#### 2.针对IP缺陷的攻击

![](../.gitbook/assets/image%20%284%29.png)

IP报文分片过程：

假如一个4800字节的IP包（IP首部长度为20B），要通过MTU为1500的网络，则需要进行分片。IP片段中偏移字段的值如下图

![](../.gitbook/assets/image%20%2867%29.png)

> 片偏移就是某片在原分组的相对位置，以8个字节为偏移单位。所以偏移字段值等于偏移值/8

（1）假如攻击者仅发送了其中的第一个分片或某个分片，其他的分片不发送，则接收方会等待一段时间（等待时间视具体系统不同而不同），在超时后，接收方会丢弃不完整的分片。当攻击者发送大量的残缺分片，则接收方或因等待过多分片而耗尽内存，导致瘫痪。

特征：属于某个原始IP数据包的分片没有全部发送，则需要判断各分片之间是否满足关系，最后一个分片是否发送。

![](../.gitbook/assets/image%20%2831%29.png)

（2）泪滴攻击

假如攻击者对正常分片的情况进行修改，把偏移字段设置成不正确的值，在分片重组的时候，可能会出现数据覆盖或断开的情况，就可能导致目标操作系统崩溃。比如，对于上述例子，将偏移字段值设置为0，150，370，555，就会发生数据覆盖；而将其修改为0，185，370，580，则会出现数据断开，这就是所谓的泪滴攻击。

特征：各分片之间偏移值、数据包长度、首部长度之间不满足紧密衔接关系。

![](../.gitbook/assets/image%20%2842%29.png)

（3）带源路由选项的IP报文

源路由选项的目的，是指明IP数据包需要通过对中间设备（路由器），即指明了报文的传输路径。源路由选项有两类，一类是严格的源路由，另一类是松散的源路由。

这些带源路由选项的IP报文在传输的过程中，其源地址不断改变，目标地址也不断改变，因此，通过合适的设置源路由节点，攻击者便可以伪造一些合法的IP地址，而蒙混进入内部网络。

特征：采用了源路由选项（代码：131、137），其源路由列表中，存在伪造的IP地址，（伪造一些访问控制设备允许进入内网的IP地址段，这些IP地址并不是路由器接口的IP）。

（4）记录路由选项的IP报文

记录路由选项也是一个IP选项，携带了该选项的IP报文，每经过一台路由器，该路由器便把自己的接口地址填在选项字段里面。这些报文在到达目的地的时候，选项的数据里面便记录了该报文经过的整个路径。

通过这样的报文可以很容易的判断报文经过的路径，从而使攻击者可以很容易的寻找其中的攻击弱点。

特征：有明显特征。一般做法是，在非调试状态下，进制使用记录路由选项，对于记录路由选项的IP报文，均认为是入侵行为。

（5）未知协议字段的IP报文

在IP报文头中，有一个协议字段，指明了该IP报文承载了何种协议的数据。如果该字段值为1，则表明该IP报文承载了ICMP报文；6则是TCP报文。等等……若攻击者将此字段设置为一个表示空协议的值，这样的报文可能对一些计算机操作系统的协议栈造成破坏。

特征：IP数据包中的协议字段的值，不代表具体的某个协议。

（6）IP地址欺骗

一般情况下，路由器在转发报文的时候，只根据报文的目的地址查路由表，而不管报文的源地址是什么，攻击者向一台计算机发出一个报文，而把报文的源地址填写为第三方的一个IP地址，这样目标计算机便可能向毫无知觉的第三方计算机回应。

特征：数据包的源IP地址字段值与其发送的报文的网络接口的IP地址不一致。

#### 3.针对ICMP缺陷的攻击

（1）ICMP泛洪

攻击者向目标计算机发送大量的ICMP ECHO请求报文（产生ICMP泛洪），则目标计算机会忙于处理并回应这些ECHO报文，而无法继续处理其他的网络数据报文，造成目标系统瘫痪。

特征：攻击者发送ICMP ECHO报文太频繁，可设置一个阈值。

（2）死亡之PING

TCP/IP规范要求IP报文的长度在一定范围内（比如，64B—64KB，但发送方没有此限制）。当接收到大于64KB长度的PING报文，可能导致目标系统IP协议栈崩溃，系统瘫痪。

特征：ping数据包的长度大于常规长度。

（3）Smurf攻击

攻击者吧ECHO的源地址设置为一个广播地址，在回复REPLY的时候，就会以广播地址为目的地址，这样本地网络上所有的计算机都必须处理这些广播报文。如果攻击者发送的ECHO请求报文足够多，产生REPLY广播风暴，就可能把整个网络淹没。攻击者还可能把源地址设置为一个子网的广播地址或者受害者的主机的IP地址。这样，该子网所在的计算机就可能受影响或者某个主机就会被ICMP REPLY淹没，造成瘫痪。

特征：ECHO报文的源地址为网段广播地址或与发送者IP不同的地址

#### 4.针对ARP缺陷的攻击

ARP的作用是找出指定的ip地址对应的MAC地址。

由请求主机以本网广播方式，发出ARP请求。目标主机以单播方式，向申请主机回应ARP应答信息，完成IP-&gt;MAC地址的过程。

![](../.gitbook/assets/image%20%2896%29.png)

#### 5.针对UDP攻击

由于UDP协议是一种无连接的服务，攻击者可以发送大量伪源IP地址的小UDP包。但是，由于UDP协议是无连接性的，所以只要开了一个UDP服务的话，就可能被攻击。

UDP Flood是流量型Dos攻击。通常是利用大量UDP小包冲击DNS或Radius认证和流媒体视频服务器等提供UDP服务的服务器。

UDP Flood特征：发送到目标IP的频率大于1K pps。小包攻击的UDP数据包，通常大小不大于200字节；打包攻击的UDP Flood数据包长通常大于1500字节。

UDP Flood是非常难以检测的，由于没有连接过程，无法建立连接状态。

#### 6.针对路由协议攻击

因特网的攻击原理是由终端主机，将IP数据包发送给路由设备，然后由路由设备根据自身学习到的或者人工设定的路由表，将IP数据包按照接力转发的方式，最终送到目标IP地址。

路由信息自动更新，路由器要根据拓扑变化，重新计算路由，并快速扩散到各相关路由器。

发送虚假的路由更新报文，将导致消耗路由资源、引起网络中断、甚至引起网络路由更新报文风暴，阻塞网络。

#### 7.内容特征

![](../.gitbook/assets/image%20%28112%29.png)

